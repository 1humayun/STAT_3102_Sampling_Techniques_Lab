######################### Problem 07 ########################
Mi = c(102, 105, 200, 88)

Behrar = c(266, 890, 311, 46, 174, 31, 17, 186, 224, 31, 102, 46, 31, 109, 275, 128, 125, 267, 153, 152, 84, 21, 52, 10, 0, 48, 94, 123, 87, 89, 109, 0, 310, 3)
Bairath = c(129, 57, 64, 11, 163, 77, 278, 50, 26, 127, 252, 194, 350, 0, 572, 149, 275, 114, 387, 53, 34, 150, 224, 185, 157, 244, 466, 203, 354, 816, 242, 140, 66, 590, 747, 147)
Ajmer = c(247, 622, 225, 278, 181, 132, 659, 403, 281, 236, 595, 265, 431, 190, 348, 232, 88, 1165, 831, 120, 987, 938, 197, 614, 187, 896, 330, 485, 60, 60, 1051, 651, 552, 968, 987)
Bansur = c(347, 362, 34, 11, 133, 36, 34, 61, 249, 170, 112, 42, 161, 75, 68, 0, 247, 186, 473, 0, 143, 198, 65, 0, 308, 122, 345, 0, 223, 302, 219, 120, 199, 35, 0, 0)

data = list(Behrar, Bairath, Ajmer, Bansur)

n = 4
N = 12
Mbar = 124
mi = sapply(data, length)
ybar.i = sapply(data, mean)

ybar = (1/(n*Mbar)) * sum(Mi*ybar.i)

Wi = Mi/Mbar
sb.2 = (1/(n-1))* sum(((Wi*ybar.i) - ybar)^2)
swi.2 = sapply(data, var)

part1 = ((1/n)-(1/N))*sb.2
part2 = (1/(n*N))*sum(Wi^2 * ((1/mi)-(1/Mi)) * sw.2^2)
v.ybar = part1 +part2